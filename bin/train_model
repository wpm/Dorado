#!/usr/bin/env python

import cPickle
from dorado import sgd_train, model_training_arguments
import gzip
import logging


args = model_training_arguments(
    "Train a classifier using stochastic gradient descent.")

logging.basicConfig(format='%(asctime)s %(message)s', 
    level = getattr(logging, args.log.upper()))

# Train the model.
model = sgd_train(
        args.classifier,
        args.train, args.validation,
        args.batch, args.patience, args.epochs, args.rate, args.frequency
    )

# Write the model to a zipped file.
with gzip.open(args.model, 'w') as f:
    cPickle.dump(model, f)
logging.info("Created model %s" % args.model)
