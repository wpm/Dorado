#!/usr/bin/env python

from dorado import sgd_train, model_training_arguments, dump_compressed
import logging


args = model_training_arguments(
    "Train a classifier using stochastic gradient descent.")

logging.basicConfig(format='%(asctime)s %(message)s', 
    level = getattr(logging, args.log.upper()))

# Train the model.
model = sgd_train(
        args.classifier,
        args.train, args.validation,
        args.batch, args.patience, args.epochs, args.rate, args.frequency
    )[0]

# Write the model to a zipped file.
dump_compressed(model, args.model)
logging.info("Created model %s" % args.model)
