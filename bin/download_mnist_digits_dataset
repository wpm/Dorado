#!/usr/bin/env python

import argparse
import dorado
import urllib

parser = argparse.ArgumentParser(description = 
"""
Download the MNIST digit recognition data.

Write it to mnist.train.pkl.gz, mnist.test.pkl.gz, and mnist.valid.pkl.gz files in the current directory.
""")
parser.parse_args()

print('Download data')
origin = 'http://www.iro.umontreal.ca/~lisa/deep/data/mnist/mnist.pkl.gz'
filename = urllib.urlretrieve(origin)[0]

train_set, valid_set, test_set = dorado.load_compressed(filename)

for data, name  in zip([train_set, valid_set, test_set], ['train', 'valid', 'test']):
    n = "mnist.%s.pkl.gz" % name
    print("Write %s" % n)
    x, y = data
    dorado.dump_compressed(dorado.LabeledData(y, x), n)
