#!/usr/bin/env python

import argparse
import cPickle
import gzip
import urllib

parser = argparse.ArgumentParser(description = 
"""
Download the MNIST digit recognition data.

Write it to mnist.train.pkl.gz, mnist.test.pkl.gz, and mnist.valid.pkl.gz files in the current directory.
""")
parser.parse_args()

print('Download data')
origin = 'http://www.iro.umontreal.ca/~lisa/deep/data/mnist/mnist.pkl.gz'
filename = urllib.urlretrieve(origin)[0]

with gzip.open(filename, 'rb') as f: 
    train_set, valid_set, test_set = cPickle.load(f)

for data, name  in zip([train_set, valid_set, test_set], ['train', 'valid', 'test']):
    n = "mnist.%s.pkl.gz" % name
    print("Write %s" % n)
    with gzip.open(n, 'w') as f:
        cPickle.dump(data, f)
